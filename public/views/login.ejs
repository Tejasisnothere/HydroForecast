<%
    // EJS Data Setup: This data MUST be passed from the server.
    const message = data.message || '';
    const errors = data.errors || [];

    // Array of FACTS justifying the "Water Reserve Predictor" project
    const justificationFacts = [
        { 
            icon: "fas fa-chart-line", 
            title: "Global Depletion", 
            text: "Over 2 billion people live in water-stressed regions, primarily due to unmanaged groundwater extraction.", 
            source: "UN Report" 
        },
        { 
            icon: "fas fa-faucet-drip", 
            title: "Crisis Visibility", 
            text: "90% of all water-related disasters are climate-driven. Prediction is the only effective defense.", 
            source: "World Bank" 
        },
        { 
            icon: "fas fa-house-damage", 
            title: "Subsidence Risk", 
            text: "Over-pumping groundwater can cause the land above to sink (subsidence), permanently reducing aquifer capacity.", 
            source: "USGS" 
        },
        { 
            icon: "fas fa-search-dollar", 
            title: "Economic Impact", 
            text: "Predictive water management can save cities millions annually by optimizing pumping costs and infrastructure.", 
            source: "Infrastructure Review" 
        }
    ];
%>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WaterMind Login</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        /* --- Dark Mode Theme Variables --- */
        :root {
            --dark-bg: #12121e;
            --card-bg: #1e1e2d;
            --primary-water: #007bff;
            --text-light: #ffffff;
            --text-muted: #a0a0b0;
            --input-bg: #2a2a3e;
            --fact-bg: #22223a; /* Dedicated background for the left pane */
        }
        
        /* Body and Centering */
        body {
            background-color: var(--dark-bg);
            color: var(--text-light);
            display: flex;
            justify-content: space-around;
            align-items: stretch; /* Stretch children vertically */
            min-height: 100vh;
            overflow: hidden; 
        }
        
        /* Fact Justification Panel (Covers Left Side) */
        .fact-panel {
            width: 50%;
            background-color: var(--fact-bg);
            padding: 60px 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-start;
            z-index: 5;
            box-shadow: 10px 0 30px rgba(0, 0, 0, 0.3);
            animation: slideInLeft 1s ease-out;
        }

        .project-title {
            font-size: 3.5rem;
            font-weight: 200;
            margin-bottom: 40px;
            color: var(--text-light);
        }

        .fact-item {
            margin-bottom: 30px;
            opacity: 0;
            transform: translateX(-20px);
            animation: fadeInFact 0.5s ease-out forwards;
        }

        .fact-item:nth-child(2) { animation-delay: 1.2s; }
        .fact-item:nth-child(3) { animation-delay: 1.5s; }
        .fact-item:nth-child(4) { animation-delay: 1.8s; }
        .fact-item:nth-child(5) { animation-delay: 2.1s; }

        .fact-icon {
            font-size: 2.5rem;
            color: var(--primary-water);
            margin-right: 20px;
        }
        .fact-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-light);
        }
        .fact-text {
            font-size: 1.1rem; /* Better visibility */
            color: var(--text-muted);
            margin-top: 5px;
        }
        
        /* The Login Card (Right Side) */
        .login-card-container {
            width: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .login-card {
            max-width: 400px;
            width: 80%;
            padding: 40px;
            border-radius: 15px;
            background-color: var(--card-bg);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
            z-index: 10;
            animation: fadeIn 0.8s ease-out;
        }
        
        /* Responsive Adjustments: Stacking on small screens */
        @media (max-width: 992px) {
            body { flex-direction: column; justify-content: flex-start; }
            .fact-panel { 
                width: 100%; 
                height: auto; 
                padding: 40px 20px;
                box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3); 
            }
            .login-card-container { width: 100%; padding: 40px 0; }
            .login-card { max-width: 90%; }
            .project-title { font-size: 2.5rem; margin-bottom: 20px; text-align: center; }
            .fact-item { text-align: center; }
            .fact-icon { margin-right: 0; margin-bottom: 10px; display: block; }
        }

        /* Form, Button, Error, Wave Styling (Minimal changes needed) */
        .form-control { background-color: var(--input-bg); color: var(--text-light); border: 1px solid #444; border-radius: 8px; }
        .form-control:focus { border-color: var(--primary-water); box-shadow: 0 0 0 0.25rem rgba(0, 123, 255, 0.4); }
        .input-group-text { background-color: #2a2a3e; border: 1px solid #444; color: var(--primary-water); border-right: none; }
        .btn-primary { background: linear-gradient(90deg, #007bff, #4c9ef7); border: none; transition: transform 0.2s ease; border-radius: 8px; }
        .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0, 123, 255, 0.4); }
        .error-list { list-style: none; padding: 0; }
        .error-list li { color: #ff6347; font-size: 0.95rem; margin-bottom: 5px; border-left: 3px solid #ff6347; padding-left: 10px; }

        /* Keyframe Animations */
        @keyframes slideInLeft { from { transform: translateX(-100%); } to { transform: translateX(0); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInFact { 
            0% { opacity: 0; transform: translateX(-20px); } 
            100% { opacity: 1; transform: translateX(0); }
        }
    </style>
</head>
<body>

    <div class="fact-panel">
        <h1 class="project-title">
            <i class="fas fa-water me-2 text-primary"></i> Water Reserve Predictor
        </h1>
        <p class="lead text-muted mb-5">
            Predictive intelligence for a sustainable future.
        </p>

        <% justificationFacts.forEach((fact, index) => { %>
            <div class="d-flex align-items-start fact-item" style="animation-delay: <%= 1 + index * 0.3 %>s;">
                <i class="<%= fact.icon %> fact-icon"></i>
                <div>
                    <h3 class="fact-title"><%= fact.title %></h3>
                    <p class="fact-text"><%= fact.text %></p>
                    <small class="text-muted">Source: <%= fact.source %></small>
                </div>
            </div>
        <% }) %>
    </div>

    <div class="login-card-container">
        <div class="login-card">
            <div class="text-center mb-5">
                <h2 class="fw-bold">Sign In</h2>
                <p class="text-muted small">Access your prediction dashboard</p>
            </div>

            <% if (message) { %>
                <div class="alert alert-danger text-center alert-dismissible fade show" role="alert">
                    <i class="fas fa-exclamation-circle me-2"></i> <%= message %>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            <% } %>
            <% if (errors.length > 0) { %>
                <ul class="error-list">
                    <% errors.forEach(error => { %>
                        <li><i class="fas fa-exclamation-triangle me-1"></i> <%= error.msg %></li>
                    <% }) %>
                </ul>
            <% } %>

            <form method="POST" action="/login"> 
                
                <div class="mb-4">
                    <label for="email" class="form-label">Email Address</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                        <input type="email" class="form-control" id="email" name="email" placeholder="user@domain.com" required autofocus>
                    </div>
                </div>

                <div class="mb-4">
                    <label for="password" class="form-label">Password</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="fas fa-lock"></i></span>
                        <input type="password" class="form-control" id="password" name="password" placeholder="••••••••" required>
                    </div>
                </div>

                <div class="d-grid mt-4">
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="fas fa-sign-in-alt me-2"></i> Access Dashboard
                    </button>
                </div>

                <p class="text-center mt-4">
                    <a href="/register" class="text-muted text-decoration-none small me-3">Need an Account?</a>
                    <a href="/forgot-password" class="text-muted text-decoration-none small">Forgot Password?</a>
                </p>
                
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>